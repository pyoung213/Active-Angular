/**
 * active-angular - ng-resource on steroids
 * @authors 
 * @version v0.0.0
 * @link 
 * @license 
 */
!function(){angular.module("activeAngular",[])}(),angular.module("activeAngular").constant("activeAngularConstant",{NO_ID:"noId"}),function(){function e(){var e="",r="items";this.setBaseUrl=function(r){e=r},this.setCollectionKey=function(e){r=e},this.$get=["$http","$q","$log","$httpParamSerializerJQLike","activeAngularCache","ActiveArray","ActiveObject","activeAngularConstant",function(t,n,i,u,a,c,o,d){function f(f,l){function s(e){return e.$edges?(_.forEach(e.$edges.get,function(r,t){e["$get"+_.capitalize(t)]=r.$edgeGet}),_.forEach(e.$edges.query,function(r,t){e["$query"+_.capitalize(t)]=r.$edgeQuery}),e):e}function $(e,r){return r=r||"",e&&(r=u(e)+r),m.call(this,e,r,!0)}function v(e){e=D(e);var r=this.url;return r=x(r,e.id),delete e.id,G=r,m.call(this,e,G,!1)}function g(e){e=D(e);var r=this.url;return r=x(r,e.id),delete e.id,G=r,m.call(this,e,G,!0)}function h(e,r){return m.call(this,e,r,!1)}function m(e,r,t){var i=this;e=D(e),e=I(e);var u=r?e.id+r:e.id,a=i.$cache.get(u);if(a&&!a.$isExpired)return a;if(!a){var d=n.defer();a=t?new c({},i):new o({},i),Object.defineProperty(a,"$promise",{enumerable:!1,value:d.promise}),Object.defineProperty(a,"$deferPromise",{enumerable:!1,value:d})}return i.$cache.set(u,a),p(e,a,t),a}function p(e,t,n){k.$$http("GET",e).then(function(e){var i=e.data,u=angular.isArray(i);if(u!=n){if(!i[r])return E(e,u);t=y(t,i),i=b(i)}i=A(i),u?(_.forEach(i,function(e,r){i[r]=O(e)}),i=k.$cache.setArray(i)):i=O(i),t=_.assign(t,i),t.$deferPromise.resolve(t)})}function y(e,t){return _.forEach(t,function(t,n){n!==r&&Object.defineProperty(e,n,{enumerable:!1,value:t})}),e}function b(e){var r={};return _.forEach(e.items,function(e,t){r[t]=e}),r}function O(e){return k.$hydrate?(_.forEach(k.$hydrate,function(r,t){return k.$edges&&k.$edges.query&&k.$edges.query[t]?void(e[t]=k.$edges.query[t].$edgeQuery.call(k,e[t]||e.id)):k.$edges&&k.$edges.get&&k.$edges.get[t]?void(e[t]=k.$edges.query[t].$edgeGet.call(k,e[t]||e.id)):void(e[t]=r.$get(e[t]))}),e):e}function A(e){return angular.isArray(e)?(e=new c(e,k),_.forEach(e,function(r,t){e[t]=new o(r,k)}),e):new o(e,k)}function E(e,t){return t?void i.error(e.config.url+" Expected an Object and got an Array from server."):void i.error(e.config.url+" Expected an Array and got an Object from server with collection key "+r+" not set.")}function j(e){var r=this;if(G="",e){e&&!e.id&&(e.id=r.id);var t=angular.copy(r),n=_.extend(r,e);return k.$cache.set(n.id,n),k.$$http("PUT",e)["catch"](function(){k.$cache.set(t.id,t)})}}function P(e){var r=this;return e=D(e),e=I(e,r),k.$$http("DELETE",e).then(function(e){k.$cache.remove(e.data.id),r.$array||_.forOwn(r,function(e,t){delete r[t]})})}function T(e){return this.$$http("POST",e)}function w(r,n){var i=this,a=n.id;return n={method:r,url:i.url,id:a,data:_.omit(n,"id")},G&&(n.url=q(n.url),n.url=G+"/"+n.url,G=""),n.id&&n.id!==d.NO_ID||(n.url=q(n.url),delete n.id),n.url=x(n.url,n.id),delete n.id,"GET"===n.method&&Object.keys(n.data).length&&(n.url+=-1==n.url.indexOf("?")?"?":"&",n.url+=u(n.data)),n.url=e+"/"+n.url,t(n)}function x(e,r){return e.indexOf(":id")>-1&&r&&(e=e.replace(":id",r)),e}function q(e){return e=e.replace(":id",""),e=e.replace("//","/"),e=_.trimEnd(e,"/")}function D(e){if(angular.isString(e)){var r=e;e={},e.id=r}return e}function I(e,r){if(angular.isUndefined(e)){e={};var t=r?r.id:d.NO_ID;e.id=t}return e}h.$inject=["options","reference"],l=l||{};var k=this,C=n.defer(),G="";k.url=f,k.$cache=a.create(l),k.$edges=l.edges,k.$hydrate=l.hydrate,k.$edges=l.edges,k.$promise=C.promise,k.$get=h,k.$query=$,k.$edgeQuery=g,k.$edgeGet=v,k.$save=j,k.$remove=P,k.$create=T,k.$$http=w,k._get=m,k._stringToObject=D,k._undefinedToObject=I,k=s(k)}return f}]}angular.module("activeAngular").provider("ActiveAngular",e)}(),function(){angular.module("activeAngular").factory("activeAngularCache",function(){function e(e){function r(e){var r=d[e];return l.isExpired(r)&&(r.$isExpired=!0),r}function t(e,r){return d[e]?(d[e].$isExpired=!1,d[e]=l.setTimestamp(d[e]),d[e]=_.extend(d[e],r)):(l.setTimestamp(r),l.setIsExpired(r),d[e]=r)}function n(e){return _.forOwn(e,function(r,t){e[t]=l.set(r.id,r)}),e}function i(e){var r=d;delete r[e],l.findAndRemove(r,e)}function u(e,r){_.forOwn(e,function(t,n){t.$isArray&&_.forOwn(t,function(t,i){return t.id===r?void delete e[n][i]:void 0})})}function a(e){if(!e)return!1;var r=e.$timestamp;if(!r)return!1;var t=(new Date).getTime();return t-r>l.cachedTime}function c(e){var r=(new Date).getTime();return angular.isDefined(e.$timestamp)||Object.defineProperty(e,"$timestamp",{enumerable:!1,get:function(){return r},set:function(e){r=e}}),e.$timestamp=r,e}function o(e){var r=!1;angular.isDefined(e.$isExpired)||Object.defineProperty(e,"$isExpired",{enumerable:!1,get:function(){return r},set:function(e){r=e}})}var d={},f=3e5;e&&e.cacheTime&&(f=e.cacheTime);var l={get:r,set:t,setArray:n,setTimestamp:c,setIsExpired:o,remove:i,findAndRemove:u,isExpired:a,cached:d,cachedTime:f};return l}var r={create:e};return r})}(),function(){angular.module("activeAngular").factory("ActiveArray",function(){function e(e,r){var t=this;_.forOwn(e,function(e,r){t[r]=e}),Object.defineProperty(t,"$remove",{enumerable:!1,value:function(e){r.$remove(e)}}),Object.defineProperty(t,"$create",{enumerable:!1,value:function(e){r.$create(e)}}),Object.defineProperty(t,"$get",{enumerable:!1,value:function(e,t){r.$get(e,t)}}),Object.defineProperty(t,"$isArray",{enumerable:!1,value:!0}),Object.defineProperty(t,"push",{enumerable:!1,value:function(e){var r=this,t=Object.keys(r).length;return e.$isArray?(_.forOwn(e,function(e){r[t]=e,t++}),r):r[t]=e}}),Object.defineProperty(t,"unshift",{enumerable:!1,value:function(e){var r=this,t=Object.keys(e).length;return _.forEachRight(r,function(e,n){r[t+n]=e}),_.forEach(e,function(e,t){r[t]=e}),r}})}return e})}(),function(){angular.module("activeAngular").factory("ActiveObject",function(){function e(e,r){var t=this;_.forOwn(e,function(e,r){t[r]=e}),Object.defineProperty(t,"$remove",{enumerable:!1,value:r.$remove}),Object.defineProperty(t,"$save",{enumerable:!1,value:r.$save})}return e})}();